<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Package Build">

<title>Lukasz Rabalski blog - Unit Tests</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Lukasz Rabalski blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">Łukasz Rąbalski blog</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/Rombix92?tab=repositories"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/%C5%82ukasz-r%C4%85balski-2892b8102/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">Unit Tests</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">Unit testing</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Package Build </p>
            </div>
    </div>
      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#problem" id="toc-problem" class="nav-link active" data-scroll-target="#problem">Problem</a>
  <ul class="collapse">
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction:</a>
  <ul class="collapse">
  <li><a href="#when-should-you-start-writing-tests" id="toc-when-should-you-start-writing-tests" class="nav-link" data-scroll-target="#when-should-you-start-writing-tests">When should you start writing tests?</a></li>
  <li><a href="#when-it-shouldnt-be-usefull" id="toc-when-it-shouldnt-be-usefull" class="nav-link" data-scroll-target="#when-it-shouldnt-be-usefull"><strong>When it shouldn’t be usefull?</strong></a></li>
  </ul></li>
  <li><a href="#python-unit-testing" id="toc-python-unit-testing" class="nav-link" data-scroll-target="#python-unit-testing">Python Unit testing</a>
  <ul class="collapse">
  <li><a href="#use-case" id="toc-use-case" class="nav-link" data-scroll-target="#use-case">Use case</a></li>
  </ul></li>
  <li><a href="#advantages-of-using-unit-test" id="toc-advantages-of-using-unit-test" class="nav-link" data-scroll-target="#advantages-of-using-unit-test">Advantages of using Unit Test</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="problem" class="level1">
<h1>Problem</h1>
<p>What Unit testing are and how they work?</p>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction:</h2>
<p>A unit test aims to check whether a part of your code operates in the intended way. Writing them has the following benefits:</p>
<ul>
<li>Reduces bugs when developing new features or when changing the existing functionality</li>
<li>Prevents unexpected output</li>
<li>Helps detecting edge cases</li>
<li>Tests can serve as documentation</li>
</ul>
<section id="when-should-you-start-writing-tests" class="level3">
<h3 class="anchored" data-anchor-id="when-should-you-start-writing-tests">When should you start writing tests?</h3>
<ul>
<li><p>The more certainty you want to have that your code works as intended, the more you want to invest in testing.</p></li>
<li><p>Especially when code is used in production, writing tests can be very valuable and ultimately time-saving.</p></li>
</ul>
</section>
<section id="when-it-shouldnt-be-usefull" class="level3">
<h3 class="anchored" data-anchor-id="when-it-shouldnt-be-usefull"><strong>When it shouldn’t be usefull?</strong></h3>
<ul>
<li>When you are exploring a dataset for the first time, you will be less inclined to write them.</li>
</ul>
</section>
</section>
<section id="python-unit-testing" class="level2">
<h2 class="anchored" data-anchor-id="python-unit-testing">Python Unit testing</h2>
<p><strong>Pytest</strong> is a great tool for writing unit tests in Python. It makes writing tests short, easy to read, and provides great output. You can install pytest using <code>pip install pytest</code> and create a folder structure like the following:</p>
<p>project/<br>
├─ src/<br>
│ ├─ regex.py<br>
│ ├─ <strong>init</strong>.py<br>
├─ test/<br>
│ ├─ test_regex.py<br>
│ ├─ <strong>init</strong>.py</p>
<section id="use-case" class="level3">
<h3 class="anchored" data-anchor-id="use-case">Use case</h3>
<div class="cell">

</div>
<div class="cell">

</div>
<p>In src/regex.py I insert following python code:</p>
<div class="cell">
<pre><code>## Help on function extract_money in module src.regex:
## 
## extract_money(text)
##     Extract monetary value from string by looking for
##     a pattern of a digit, followed by 'euro'.
##     e.g. 5 euro --&gt; 5
##     Args:
##         text (str): Text containing monetary value
##     Returns:
##         float: The extracted value</code></pre>
</div>
<p>While <code>test/test_regex.py</code> I hold following code.</p>
<div class="cell">
<pre><code>## import sys
## sys.path.insert(0, '/Users/lrabalski1/Desktop/prv/blog/content/post/2022-11-11-unit-tests')
## 
## 
## from src.regex import extract_money
## import pytest
## 
## 
## def test_empty_string():
##     empty_string = ""
##     extracted_money = extract_money(empty_string)
##     expected_output = None
##     assert extracted_money == expected_output
## 
## def test_money_with_decimal_numbers():
##     decimal_string = "5.49 euro"
##     extracted_money = extract_money(decimal_string)
##     assert extracted_money == 5.49</code></pre>
</div>
<p>If the code is localised in the file with suffix “test_” and within folder “test_” then running code bellow from <code>root directory</code> will run test unit test.</p>
<div class="cell">
<pre><code>## ============================= test session starts ==============================
## platform darwin -- Python 3.8.12, pytest-7.2.0, pluggy-1.0.0 -- /Users/lrabalski1/miniforge3/envs/everyday_use/bin/python3.8
## cachedir: .pytest_cache
## rootdir: /Users/lrabalski1/Desktop/prv/blog_quarto/posts/2022-11-11-unit-tests
## collecting ... collected 0 items / 1 error
## 
## ==================================== ERRORS ====================================
## _____________________ ERROR collecting test/test_regex.py ______________________
## ImportError while importing test module '/Users/lrabalski1/Desktop/prv/blog_quarto/posts/2022-11-11-unit-tests/test/test_regex.py'.
## Hint: make sure your test modules/packages have valid Python names.
## Traceback:
## ../../../../../miniforge3/envs/everyday_use/lib/python3.8/importlib/__init__.py:127: in import_module
##     return _bootstrap._gcd_import(name[level:], package, level)
## /Users/lrabalski1/Desktop/prv/blog/content/post/2022-11-11-unit-tests/test/test_regex.py:5: in &lt;module&gt;
##     ???
## E   ModuleNotFoundError: No module named 'src'
## =========================== short test summary info ============================
## ERROR test/test_regex.py
## !!!!!!!!!!!!!!!!!!!! Interrupted: 1 error during collection !!!!!!!!!!!!!!!!!!!!
## =============================== 1 error in 0.14s ===============================</code></pre>
</div>
<p>As you can see</p>
<ul>
<li><p>first test went positive, function work well with empty string</p></li>
<li><p>second test failed, we got an AssertionError, stating that 9 is not equal to 5.49. It seems that our function only extracted the last digit of 5.49. Without this test, we would have been less likely to catch this error. The function would have returned the value 9, instead of throwing us an error.</p></li>
</ul>
</section>
</section>
<section id="advantages-of-using-unit-test" class="level2">
<h2 class="anchored" data-anchor-id="advantages-of-using-unit-test">Advantages of using Unit Test</h2>
<p>The next step is to fix our code and make sure that it now passes the test that failed before, while still passing the first test that we wrote as well. A great thing about unit testing is that it gives you an overview of how your changes affect the project as a whole. The tests will make you aware if any of your code additions cause any unexpected consequences.</p>
<p>Furthermore, the fact that our initial function did not pass the decimal number test raises the question what other examples might come up that we did not anticipate. Maybe we will get a number separated by a comma, like 5,49 euro. Or the monetary value is formatted as € 5.49,-. Unit testing allows us to quickly check for these cases and some other less-common **edge cases**.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb4" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">---</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="an">title:</span><span class="co"> Unit Tests</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="an">author:</span><span class="co"> Package Build</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="an">categories:</span><span class="co"> ['Unit testing']</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="an">tags:</span><span class="co"> ['Python', 'Unit testing']</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">---</span></span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="in">```{r markdown_parameters, include=FALSE}</span></span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#markdown ----</span></span>
<span id="cb4-12"><a href="#cb4-12"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="co">#fig.width=12, </span></span>
<span id="cb4-13"><a href="#cb4-13"></a>                      <span class="at">fig.height=</span><span class="dv">4</span>,</span>
<span id="cb4-14"><a href="#cb4-14"></a>                       <span class="at">out.width =</span> <span class="st">'100%'</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>                      ) </span>
<span id="cb4-16"><a href="#cb4-16"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">include =</span><span class="cn">TRUE</span>, <span class="co">#prevents code and results from appearing in the finished file. R Markdown still runs the code in the chunk, and the results can be used by other chunks.</span></span>
<span id="cb4-17"><a href="#cb4-17"></a>                      <span class="at">echo =</span> <span class="cn">FALSE</span>, <span class="co">#echo = FALSE prevents code, but not the results from appearing in the finished file. This is a useful way to embed figures.</span></span>
<span id="cb4-18"><a href="#cb4-18"></a>                      <span class="at">warning =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-19"><a href="#cb4-19"></a>                      <span class="at">message =</span><span class="cn">FALSE</span>,</span>
<span id="cb4-20"><a href="#cb4-20"></a>                      <span class="at">collapse=</span><span class="cn">TRUE</span>,</span>
<span id="cb4-21"><a href="#cb4-21"></a>                      <span class="at">error=</span><span class="cn">TRUE</span></span>
<span id="cb4-22"><a href="#cb4-22"></a>                      )</span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="fu">options</span>(<span class="at">scipen=</span><span class="dv">999</span>)</span>
<span id="cb4-24"><a href="#cb4-24"></a><span class="in">```</span></span>
<span id="cb4-25"><a href="#cb4-25"></a></span>
<span id="cb4-26"><a href="#cb4-26"></a><span class="fu"># Problem</span></span>
<span id="cb4-27"><a href="#cb4-27"></a></span>
<span id="cb4-28"><a href="#cb4-28"></a>What Unit testing are and how they work?</span>
<span id="cb4-29"><a href="#cb4-29"></a></span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="fu">## Introduction:</span></span>
<span id="cb4-31"><a href="#cb4-31"></a></span>
<span id="cb4-32"><a href="#cb4-32"></a>A unit test aims to check whether a part of your code operates in the intended way. Writing them has the following benefits:</span>
<span id="cb4-33"><a href="#cb4-33"></a></span>
<span id="cb4-34"><a href="#cb4-34"></a><span class="ss">-   </span>Reduces bugs when developing new features or when changing the existing functionality</span>
<span id="cb4-35"><a href="#cb4-35"></a><span class="ss">-   </span>Prevents unexpected output</span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="ss">-   </span>Helps detecting edge cases</span>
<span id="cb4-37"><a href="#cb4-37"></a><span class="ss">-   </span>Tests can serve as documentation</span>
<span id="cb4-38"><a href="#cb4-38"></a></span>
<span id="cb4-39"><a href="#cb4-39"></a><span class="fu">### When should you start writing tests?</span></span>
<span id="cb4-40"><a href="#cb4-40"></a></span>
<span id="cb4-41"><a href="#cb4-41"></a><span class="ss">-   </span>The more certainty you want to have that your code works as intended, the more you want to invest in testing.</span>
<span id="cb4-42"><a href="#cb4-42"></a></span>
<span id="cb4-43"><a href="#cb4-43"></a><span class="ss">-   </span>Especially when code is used in production, writing tests can be very valuable and ultimately time-saving.</span>
<span id="cb4-44"><a href="#cb4-44"></a></span>
<span id="cb4-45"><a href="#cb4-45"></a><span class="fu">### **When it shouldn't be usefull?**</span></span>
<span id="cb4-46"><a href="#cb4-46"></a></span>
<span id="cb4-47"><a href="#cb4-47"></a><span class="ss">-   </span>When you are exploring a dataset for the first time, you will be less inclined to write them.</span>
<span id="cb4-48"><a href="#cb4-48"></a></span>
<span id="cb4-49"><a href="#cb4-49"></a><span class="fu">## Python Unit testing</span></span>
<span id="cb4-50"><a href="#cb4-50"></a></span>
<span id="cb4-51"><a href="#cb4-51"></a>**Pytest** is a great tool for writing unit tests in Python. It makes writing tests short, easy to read, and provides great output. You can install pytest using <span class="in">`pip install pytest`</span> and create a folder structure like the following:</span>
<span id="cb4-52"><a href="#cb4-52"></a></span>
<span id="cb4-53"><a href="#cb4-53"></a>project/\</span>
<span id="cb4-54"><a href="#cb4-54"></a>├─ src/\</span>
<span id="cb4-55"><a href="#cb4-55"></a>│ ├─ regex.py\</span>
<span id="cb4-56"><a href="#cb4-56"></a>│ ├─ **init**.py\</span>
<span id="cb4-57"><a href="#cb4-57"></a>├─ test/\</span>
<span id="cb4-58"><a href="#cb4-58"></a>│ ├─ test_regex.py\</span>
<span id="cb4-59"><a href="#cb4-59"></a>│ ├─ **init**.py</span>
<span id="cb4-60"><a href="#cb4-60"></a></span>
<span id="cb4-61"><a href="#cb4-61"></a><span class="fu">### Use case</span></span>
<span id="cb4-62"><a href="#cb4-62"></a></span>
<span id="cb4-65"><a href="#cb4-65"></a><span class="in">```{r}</span></span>
<span id="cb4-66"><a href="#cb4-66"></a><span class="fu">library</span>(reticulate)</span>
<span id="cb4-67"><a href="#cb4-67"></a></span>
<span id="cb4-68"><a href="#cb4-68"></a><span class="fu">Sys.setenv</span>(<span class="at">RETICULATE_PYTHON =</span> <span class="st">"/Users/lrabalski1/miniforge3/envs/everyday_use/bin/python"</span>)</span>
<span id="cb4-69"><a href="#cb4-69"></a></span>
<span id="cb4-70"><a href="#cb4-70"></a>myenvs<span class="ot">=</span><span class="fu">conda_list</span>()</span>
<span id="cb4-71"><a href="#cb4-71"></a>envname<span class="ot">=</span>myenvs<span class="sc">$</span>name[<span class="dv">3</span>]</span>
<span id="cb4-72"><a href="#cb4-72"></a><span class="fu">use_condaenv</span>(envname, <span class="at">required =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-73"><a href="#cb4-73"></a><span class="in">```</span></span>
<span id="cb4-74"><a href="#cb4-74"></a></span>
<span id="cb4-77"><a href="#cb4-77"></a><span class="in">```{python}</span></span>
<span id="cb4-78"><a href="#cb4-78"></a><span class="im">import</span> sys  </span>
<span id="cb4-79"><a href="#cb4-79"></a>sys.path.insert(<span class="dv">0</span>, <span class="st">'/Users/lrabalski1/Desktop/prv/blog/content/post/2022-11-11-unit-tests'</span>)</span>
<span id="cb4-80"><a href="#cb4-80"></a><span class="in">```</span></span>
<span id="cb4-81"><a href="#cb4-81"></a></span>
<span id="cb4-82"><a href="#cb4-82"></a>In src/regex.py I insert following python code:</span>
<span id="cb4-83"><a href="#cb4-83"></a></span>
<span id="cb4-86"><a href="#cb4-86"></a><span class="in">```{python}</span></span>
<span id="cb4-87"><a href="#cb4-87"></a><span class="im">from</span> src.regex <span class="im">import</span> extract_money </span>
<span id="cb4-88"><a href="#cb4-88"></a></span>
<span id="cb4-89"><a href="#cb4-89"></a><span class="bu">help</span>(extract_money)</span>
<span id="cb4-90"><a href="#cb4-90"></a><span class="in">```</span></span>
<span id="cb4-91"><a href="#cb4-91"></a></span>
<span id="cb4-92"><a href="#cb4-92"></a>While <span class="in">`test/test_regex.py`</span> I hold following code.</span>
<span id="cb4-93"><a href="#cb4-93"></a></span>
<span id="cb4-96"><a href="#cb4-96"></a><span class="in">```{r}</span></span>
<span id="cb4-97"><a href="#cb4-97"></a><span class="fu">library</span>(readr)</span>
<span id="cb4-98"><a href="#cb4-98"></a><span class="fu">cat</span>(readr<span class="sc">::</span><span class="fu">read_file</span>(<span class="st">'test/test_regex.py'</span>))</span>
<span id="cb4-99"><a href="#cb4-99"></a><span class="in">```</span></span>
<span id="cb4-100"><a href="#cb4-100"></a></span>
<span id="cb4-101"><a href="#cb4-101"></a>If the code is localised in the file with suffix "test<span class="sc">\_</span>" and within folder "test<span class="sc">\_</span>" then running code bellow from <span class="in">`root directory`</span> will run test unit test.</span>
<span id="cb4-102"><a href="#cb4-102"></a></span>
<span id="cb4-103"><a href="#cb4-103"></a><span class="in">```{bash, include=TRUE}</span></span>
<span id="cb4-104"><a href="#cb4-104"></a><span class="ex">pytest</span> <span class="at">-v</span></span>
<span id="cb4-105"><a href="#cb4-105"></a><span class="in">```</span></span>
<span id="cb4-106"><a href="#cb4-106"></a></span>
<span id="cb4-107"><a href="#cb4-107"></a>As you can see</span>
<span id="cb4-108"><a href="#cb4-108"></a></span>
<span id="cb4-109"><a href="#cb4-109"></a><span class="ss">-   </span>first test went positive, function work well with empty string</span>
<span id="cb4-110"><a href="#cb4-110"></a></span>
<span id="cb4-111"><a href="#cb4-111"></a><span class="ss">-   </span>second test failed, we got an AssertionError, stating that 9 is not equal to 5.49. It seems that our function only extracted the last digit of 5.49. Without this test, we would have been less likely to catch this error. The function would have returned the value 9, instead of throwing us an error.</span>
<span id="cb4-112"><a href="#cb4-112"></a></span>
<span id="cb4-113"><a href="#cb4-113"></a><span class="fu">## Advantages of using Unit Test</span></span>
<span id="cb4-114"><a href="#cb4-114"></a></span>
<span id="cb4-115"><a href="#cb4-115"></a>The next step is to fix our code and make sure that it now passes the test that failed before, while still passing the first test that we wrote as well. A great thing about unit testing is that it gives you an overview of how your changes affect the project as a whole. The tests will make you aware if any of your code additions cause any unexpected consequences.</span>
<span id="cb4-116"><a href="#cb4-116"></a></span>
<span id="cb4-117"><a href="#cb4-117"></a>Furthermore, the fact that our initial function did not pass the decimal number test raises the question what other examples might come up that we did not anticipate. Maybe we will get a number separated by a comma, like 5,49 euro. Or the monetary value is formatted as € 5.49,-. Unit testing allows us to quickly check for these cases and some other less-common <span class="sc">\*\*</span>edge cases<span class="sc">\*\*</span>.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>